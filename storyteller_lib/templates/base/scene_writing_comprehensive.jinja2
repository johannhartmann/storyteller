{# Comprehensive scene writing template with full context #}
You are writing Chapter {{ chapter }}, Scene {{ scene }} of a {{ tone }} {{ genre }} story.

## STORY CONTEXT

{% if initial_idea %}
The story began with this idea: {{ initial_idea }}
{% endif %}

The overall premise: {{ story_premise }}

{% if author %}
Write in the style of {{ author }}, capturing their narrative techniques.
{% endif %}

## CURRENT CHAPTER

You are in Chapter {{ chapter }}: {{ chapter_title }}

This chapter focuses on: {{ chapter_outline }}

{% if chapter_themes %}
Key themes to weave in: {{ chapter_themes|join(', ') }}
{% endif %}

## THIS SCENE'S PURPOSE

This is a {{ scene_type }} scene with {{ dramatic_purpose }} as its dramatic purpose.

What must happen: {{ scene_description }}

Build tension to {{ tension_level }}/10 and end with a {{ scene_ending }}.

{% if plot_progressions %}
## PLOT PROGRESSIONS

The following plot points must occur naturally in this scene:
{% for prog in plot_progressions %}
- {{ prog.description }}{% if prog.already_occurred %} (WARNING: This already happened - reference it, don't repeat it){% endif %}
{% endfor %}
{% endif %}

{% if active_threads %}
## ONGOING STORY THREADS

These plot threads are currently active and may be relevant:
{% for thread in active_threads %}

{{ thread.name }} ({{ thread.importance }}): {{ thread.description }}
  Last development: {{ thread.last_development }}
{% endfor %}
{% endif %}

## CHARACTERS

The following characters must appear: {{ required_characters|join(', ') }}

{% for char in characters %}
{{ char.name }} ({{ char.role }}):
- Emotional state: {{ char.emotional_state }}
- Driven by: {{ char.motivation }}
{% if char.recent_knowledge %}
- Recently learned: {{ char.recent_knowledge[0].content }}
{% endif %}

{% endfor %}

{% if character_relationships %}
Relationships:
{% for rel in character_relationships %}
- {{ rel.character1 }} and {{ rel.character2 }}: {{ rel.type }} - {{ rel.description }}
{% endfor %}
{% endif %}

{% if character_learning %}
Characters must learn: {{ character_learning|join(', ') }}
{% endif %}

{% if locations %}
## SETTING

Relevant locations:
{% for loc in locations[:3] %}
- {{ loc.name }}: {{ loc.description }}
{% endfor %}
{% endif %}

## SCENE CONTINUITY

{% if previous_summary %}
Recent events:
{{ previous_summary }}
{% endif %}

{% if previous_ending %}
The previous scene ended with:
{{ previous_ending }}

Pick up naturally from this ending.
{% endif %}

{% if next_preview %}
Coming next: {{ next_preview }}
Set this up but don't start it.
{% endif %}

## WRITING CONSTRAINTS

{% if forbidden_repetitions %}
Avoid these repetitive elements:
{% for item in forbidden_repetitions[:5] %}
- {{ item }}
{% endfor %}
{% endif %}

{% if recent_scene_types %}
Recent scene types (avoid repeating): {{ recent_scene_types[:3]|join(', ') }}
{% endif %}

## STYLE GUIDE

{{ style_guide }}

## INSTRUCTIONS

1. Start immediately with action, dialogue, or vivid description
2. Stay fully in scene - no summaries or time skips
3. Show character emotions through actions and dialogue
4. Weave plot progressions naturally into character actions
5. Build tension gradually to the target level
6. End with the specified type of ending that propels the story forward
7. Write 800-1200 words

Write the scene now: